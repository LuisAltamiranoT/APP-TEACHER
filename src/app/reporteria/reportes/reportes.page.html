<ion-header>
  <ion-toolbar>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <h3 class="font-weight-normal">
          <mat-icon class="fa-nival" matSuffix>list_alt</mat-icon> Reportes
          <hr class="hr-nival">
        </h3>
        <button mat-button style="display: inline;" (click)="exportToExcel()" [disabled]="!ValidateButton">
          <mat-icon class="fa-nival" matSuffix>
            get_app
          </mat-icon>
          Descargar
        </button>
        <button mat-button style="display: inline; float: right;" (click)="verFiltros()" [disabled]="!ValidateButton">
          <mat-icon class="fa-nival" matSuffix>
            filter_list
          </mat-icon>
          Filtros
        </button>
        <hr class="hr-nival">
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="12">
        <form [formGroup]="fechaForm" (ngSubmit)="filtrar()" style="display: inline;" *ngIf="activarFiltros">
          <ion-row>
            <ion-col size="6">
              <button mat-button [disabled]="!limpiarInput" (click)="limpiarBusqueda(input)">
                <mat-icon>
                  search
                </mat-icon>
                Buscar
              </button>
            </ion-col>
            <ion-col size="6">
              <button mat-button [disabled]="!limpiarInput" (click)="limpiarImput()" style="float: right;">
                <mat-icon matSuffix>backspace</mat-icon>
                Limpiar
              </button>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="6">
              <mat-form-field appearance="standard" class="input-modal">
                <mat-label>Inicio</mat-label>
                <input autocomplete="off" matInput [matDatepickerFilter]="myFilter" [matDatepicker]="picker"
                  formControlName="inicio" readonly (dateInput)="activarBusqueda()">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
            </ion-col>
            <ion-col size="6">
              <mat-form-field appearance="standard" class="input-modal">
                <mat-label>Final</mat-label>
                <input autocomplete="off" matInput [matDatepickerFilter]="myFilter" [matDatepicker]="picker1"
                  formControlName="fin" readonly (dateInput)="validarFecha($event, fechaForm.value)">
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
              </mat-form-field>
            </ion-col>
          </ion-row>
        </form>
        <mat-form-field appearance="standard" class="input-modal">
          <mat-label>Buscar</mat-label>
          <input matInput autocomplete="off" (keyup)="applyFilter($event)" placeholder="Ejemplo 201720 o Pepito Perez"
            #input>
          <mat-icon matSuffix (click)="limpiarBusqueda(input)">backspace</mat-icon>
        </mat-form-field>
      </ion-col>
      <ion-col size="12">
        <div class="example-container mat-elevation-z3">
          <table mat-table [dataSource]="dataSource" #table>
            <ng-container *ngFor="let disCol of displayedColumns; let colIndex = index" [ngSwitch]="disCol"
              matColumnDef="{{disCol}}" [sticky]="isSticky(disCol)">
              <th mat-header-cell *matHeaderCellDef>{{disCol}}</th>

              <ng-container *ngSwitchCase="'Numero'">
                <td class="number" mat-cell *matCellDef="let element "> {{element[disCol]}}</td>
              </ng-container>

              <ng-container *ngSwitchCase="'Nombre'">
                <td mat-cell *matCellDef="let element "> {{element[disCol]}}</td>
              </ng-container>

              <ng-container *ngSwitchCase="'Imagen'">
                <td mat-cell *matCellDef="let element, let i = index;">
                  <a (click)="openPhoto(element[disCol])">
                    <img mat-card-image class="avatarNivalStudent" src={{element[disCol]}} alt="noImage">
                  </a>
                </td>
              </ng-container>

              <ng-container *ngSwitchCase="'Porcentaje'">
                <td mat-cell *matCellDef="let element">{{element[disCol]}}</td>
              </ng-container>

              <ng-container *ngSwitchDefault>
                <td mat-cell *matCellDef="let element,let i = index;">
                  <button mat-button [ngStyle]="{'backgroundColor':getColor(element[disCol])}"
                    style="color: white; width: 100px; margin-left: 3px;"
                    (click)="onclick(element[disCol],element['Numero'],disCol)">{{element[disCol]}}</button>
                </td>
              </ng-container>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

</ion-content>

<ion-footer>
  <ion-toolbar>
  </ion-toolbar>
</ion-footer>